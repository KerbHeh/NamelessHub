-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘         BROOKHAVEN ADMIN HD  â€”  v7                          â•‘
-- â•‘   Movimento Â· Jogador Â· Brookhaven Â· Visual Â· Mundo Â· Misc  â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function safeLoad(url, nome)
    local ok, res = pcall(function()
        return loadstring(game:HttpGet(url, true))()
    end)
    if not ok then error("[AdminHD] Falhou: " .. nome .. "\n" .. tostring(res), 0) end
    return res
end

local Fluent           = safeLoad("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua", "Fluent")
local SaveManager      = safeLoad("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua", "SaveManager")
local InterfaceManager = safeLoad("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua", "InterfaceManager")

-- â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
-- â”‚              SERVIÃ‡OS                   â”‚
-- â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
local Players     = game:GetService("Players")
local RunService  = game:GetService("RunService")
local UserInput   = game:GetService("UserInputService")
local Lighting    = game:GetService("Lighting")
local VirtualUser = game:GetService("VirtualUser")
local Debris      = game:GetService("Debris")
local LP          = Players.LocalPlayer

-- â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
-- â”‚               JANELA                    â”‚
-- â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
local Window = Fluent:CreateWindow({
    Title       = "Brookhaven Admin HD",
    SubTitle    = "v7  Â·  FE Safe",
    TabWidth    = 168,
    Size        = UDim2.fromOffset(680, 540),
    Acrylic     = false,
    Theme       = "Dark",
    MinimizeKey = Enum.KeyCode.RightControl,
})

local T = {
    Move = Window:AddTab({ Title = "Movimento",  Icon = "zap"      }),
    Play = Window:AddTab({ Title = "Jogador",    Icon = "user"     }),
    BK   = Window:AddTab({ Title = "Brookhaven", Icon = "car"      }),
    Vis  = Window:AddTab({ Title = "Visual",     Icon = "eye"      }),
    Wld  = Window:AddTab({ Title = "Mundo",      Icon = "globe"    }),
    Mis  = Window:AddTab({ Title = "Misc",       Icon = "star"     }),
    Cfg  = Window:AddTab({ Title = "Config",     Icon = "settings" }),
}

local Options = Fluent.Options

-- â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
-- â”‚         SISTEMA DE CONEXÃ•ES             â”‚
-- â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
local C = {}
local function con(k, sig, fn) if C[k] then C[k]:Disconnect() end; C[k] = sig:Connect(fn) end
local function dis(k) if C[k] then C[k]:Disconnect(); C[k] = nil end end

-- â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
-- â”‚              ATALHOS                    â”‚
-- â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
local function getChar()  return LP.Character end
local function getRoot()  local c = getChar() return c and c:FindFirstChild("HumanoidRootPart") end
local function getHum()   local c = getChar() return c and c:FindFirstChildOfClass("Humanoid") end
local function getMouse() return LP:GetMouse() end
local function getCam()   return workspace.CurrentCamera end

local function notify(titulo, msg, dur)
    Fluent:Notify({ Title = titulo, Content = msg, Duration = dur or 4 })
end

local SCALES = { "BodyHeightScale", "BodyDepthScale", "BodyWidthScale", "HeadScale" }
local function applyScale(s)
    local h = getHum(); if not h then return end
    for _, n in ipairs(SCALES) do
        local v = h:FindFirstChild(n); if v then v.Value = s end
    end
end

local ORIG = {
    Brightness    = Lighting.Brightness,
    ClockTime     = Lighting.ClockTime,
    FogEnd        = Lighting.FogEnd,
    FogColor      = Lighting.FogColor,
    GlobalShadows = Lighting.GlobalShadows,
    Ambient       = Lighting.Ambient,
}

local function findTool(...)
    for _, n in ipairs({...}) do
        local f = LP.Backpack:FindFirstChild(n)
            or (getChar() and getChar():FindFirstChild(n))
            or workspace:FindFirstChild(n, true)
        if f then return f end
    end
    return nil
end

-- VehicleSeat atual (qualquer veÃ­culo no workspace que LP esteja usando)
local function getVehicleSeat()
    local h = getHum(); if not h then return nil end
    local s = h.SeatPart
    return (s and s:IsA("VehicleSeat")) and s or nil
end

-- TambÃ©m procura VehicleSeat no workspace inteiro que esteja "vazio"
-- para casos onde o Brookhaven usa scripts prÃ³prios
local function findAnyVehicleSeat()
    local seat = getVehicleSeat()
    if seat then return seat end
    -- Tenta achar pela distÃ¢ncia (<=20 studs)
    local root = getRoot(); if not root then return nil end
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("VehicleSeat") then
            local dist = (obj.Position - root.Position).Magnitude
            if dist <= 20 then return obj end
        end
    end
    return nil
end

local function playerList()
    local t = {}
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= LP then table.insert(t, p.Name) end
    end
    return #t > 0 and t or { "(nenhum)" }
end

LP.CharacterAdded:Connect(function()
    task.wait(1.5)
    local h = getHum(); if not h then return end
    if Options.WalkSpeed then h.WalkSpeed  = Options.WalkSpeed.Value end
    if Options.JumpPower then
        h.JumpPower  = Options.JumpPower.Value
        h.JumpHeight = Options.JumpPower.Value
    end
    if Options.SizeScale then applyScale(Options.SizeScale.Value) end
    if Options.GodMode and Options.GodMode.Value then
        con("god", RunService.Heartbeat, function()
            local hm = getHum(); if hm then hm.Health = hm.MaxHealth end
        end)
    end
end)

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    ABA  MOVIMENTO                           â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T.Move:AddParagraph({
    Title   = "Controle de Movimento",
    Content = "Todos os sliders aplicam em tempo real no personagem.",
})

T.Move:AddSlider("WalkSpeed", {
    Title = "Velocidade (WalkSpeed)", Description = "PadrÃ£o: 16",
    Default = 16, Min = 0, Max = 500, Rounding = 0,
    Callback = function(v) local h = getHum(); if h then h.WalkSpeed = v end end,
})

T.Move:AddSlider("JumpPower", {
    Title = "Pulo (JumpPower)", Description = "PadrÃ£o: 50",
    Default = 50, Min = 0, Max = 500, Rounding = 0,
    Callback = function(v)
        local h = getHum()
        if h then h.JumpPower = v; h.JumpHeight = v end
    end,
})

T.Move:AddSlider("SizeScale", {
    Title = "Tamanho (Scale)", Description = "1 = normal | 0.1 = micro | 5 = gigante",
    Default = 1, Min = 0.1, Max = 5, Rounding = 2,
    Callback = function(v) applyScale(v) end,
})

T.Move:AddToggle("Sprint", {
    Title = "Sprint (Shift)", Description = "Shift = 2.5Ã— velocidade configurada",
    Default = false,
    Callback = function(v)
        dis("sprint")
        if not v then
            local h = getHum(); if h then h.WalkSpeed = Options.WalkSpeed.Value end
            return
        end
        con("sprint", RunService.Heartbeat, function()
            local h = getHum(); if not h then return end
            h.WalkSpeed = Options.WalkSpeed.Value
                * (UserInput:IsKeyDown(Enum.KeyCode.LeftShift) and 2.5 or 1)
        end)
    end,
})

local flySpeed  = 60
local flyActive = false

T.Move:AddToggle("Fly", {
    Title = "Voar (Fly)", Description = "WASD = direÃ§Ã£o | EspaÃ§o = subir | Ctrl = descer",
    Default = false,
    Callback = function(v)
        flyActive = v
        local root = getRoot(); if not root then return end
        if not v then
            dis("fly")
            for _, o in ipairs(root:GetChildren()) do
                if o:IsA("BodyVelocity") or o:IsA("BodyGyro") then o:Destroy() end
            end
            return
        end

        local bv = Instance.new("BodyVelocity")
        bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
        bv.Velocity = Vector3.zero
        bv.Parent   = root

        local bg = Instance.new("BodyGyro")
        bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
        bg.D = 50
        bg.Parent = root

        local cam = getCam()
        con("fly", RunService.Heartbeat, function()
            if not flyActive then return end
            root = getRoot(); if not root then return end
            local dir = Vector3.zero
            if UserInput:IsKeyDown(Enum.KeyCode.W)           then dir += cam.CFrame.LookVector  end
            if UserInput:IsKeyDown(Enum.KeyCode.S)           then dir -= cam.CFrame.LookVector  end
            if UserInput:IsKeyDown(Enum.KeyCode.A)           then dir -= cam.CFrame.RightVector end
            if UserInput:IsKeyDown(Enum.KeyCode.D)           then dir += cam.CFrame.RightVector end
            if UserInput:IsKeyDown(Enum.KeyCode.Space)       then dir += Vector3.new(0, 1, 0)   end
            if UserInput:IsKeyDown(Enum.KeyCode.LeftControl) then dir -= Vector3.new(0, 1, 0)   end
            bv.Velocity = dir.Magnitude > 0 and dir.Unit * flySpeed or Vector3.zero
            bg.CFrame   = cam.CFrame
        end)
    end,
})

T.Move:AddSlider("FlySpeedSlider", {
    Title = "Velocidade do Voo", Description = "PadrÃ£o: 60",
    Default = 60, Min = 10, Max = 500, Rounding = 0,
    Callback = function(v) flySpeed = v end,
})

T.Move:AddButton({
    Title = "Resetar Movimento",
    Description = "Velocidade 16 Â· Pulo 50 Â· Tamanho 1",
    Callback = function()
        Options.WalkSpeed:SetValue(16)
        Options.JumpPower:SetValue(50)
        Options.SizeScale:SetValue(1)
        notify("Reset", "Movimento restaurado ao padrÃ£o.")
    end,
})

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                     ABA  JOGADOR                           â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T.Play:AddToggle("GodMode", {
    Title = "God Mode", Description = "HP sempre no mÃ¡ximo",
    Default = false,
    Callback = function(v)
        dis("god")
        if v then con("god", RunService.Heartbeat, function()
            local h = getHum(); if h then h.Health = h.MaxHealth end
        end) end
    end,
})

T.Play:AddToggle("Noclip", {
    Title = "Noclip", Description = "Atravessa paredes e objetos",
    Default = false,
    Callback = function(v)
        dis("noclip")
        if v then
            con("noclip", RunService.Stepped, function()
                local c = getChar(); if not c then return end
                for _, p in ipairs(c:GetDescendants()) do
                    if p:IsA("BasePart") then p.CanCollide = false end
                end
            end)
        else
            local c = getChar(); if not c then return end
            for _, p in ipairs(c:GetDescendants()) do
                if p:IsA("BasePart") then p.CanCollide = true end
            end
        end
    end,
})

T.Play:AddToggle("AntiAFK", {
    Title = "Anti-AFK", Description = "Nunca toma kick por inatividade",
    Default = false,
    Callback = function(v)
        dis("afk")
        if v then
            con("afk", LP.Idled, function()
                VirtualUser:Button2Down(Vector2.new(0, 0), getCam().CFrame)
                task.wait(0.1)
                VirtualUser:Button2Up(Vector2.new(0, 0), getCam().CFrame)
            end)
        end
    end,
})

T.Play:AddToggle("Invisible", {
    Title = "Invisibilidade (local)", Description = "SÃ³ vocÃª desaparece na sua tela",
    Default = false,
    Callback = function(v)
        local c = getChar(); if not c then return end
        for _, p in ipairs(c:GetDescendants()) do
            if p:IsA("BasePart") then p.LocalTransparencyModifier = v and 1 or 0 end
        end
    end,
})

T.Play:AddButton({
    Title = "Teleport â†’ Spawn",
    Callback = function()
        local root  = getRoot()
        local spawn = workspace:FindFirstChildOfClass("SpawnLocation")
        if root and spawn then
            root.CFrame = spawn.CFrame + Vector3.new(0, 5, 0)
            notify("Teleport", "Chegou no Spawn!")
        else
            notify("Erro", "SpawnLocation nÃ£o encontrado.")
        end
    end,
})

T.Play:AddButton({
    Title = "Teleport â†’ Cursor (clique no mapa)",
    Callback = function()
        notify("Modo Clique", "Clique no chÃ£o. ESC cancela.")
        local tmp
        tmp = UserInput.InputBegan:Connect(function(inp)
            if inp.UserInputType == Enum.UserInputType.MouseButton1 then
                local mouse = getMouse(); local root = getRoot()
                if root and mouse.Target then
                    root.CFrame = CFrame.new(mouse.Hit.Position + Vector3.new(0, 5, 0))
                    notify("Teleport", "Teleportado!")
                end
                tmp:Disconnect()
            elseif inp.KeyCode == Enum.KeyCode.Escape then
                tmp:Disconnect(); notify("Cancelado", "Teleport cancelado.")
            end
        end)
    end,
})

T.Play:AddParagraph({
    Title   = "Teleport para Jogador",
    Content = "Selecione no dropdown e clique no botÃ£o.",
})

local dropTpPlayer = T.Play:AddDropdown("TpPlayerTarget", {
    Title    = "Selecionar Jogador",
    Values   = playerList(),
    Default  = playerList()[1],
    Multi    = false,
    Callback = function(_) end,
})

T.Play:AddButton({
    Title = "âš¡ Ir atÃ© o Jogador Selecionado",
    Callback = function()
        local nome = Options.TpPlayerTarget and Options.TpPlayerTarget.Value
        if not nome or nome == "(nenhum)" then notify("Erro", "Selecione um jogador."); return end
        local alvo = Players:FindFirstChild(nome)
        local root = getRoot()
        if alvo and alvo.Character and alvo.Character:FindFirstChild("HumanoidRootPart") and root then
            root.CFrame = alvo.Character.HumanoidRootPart.CFrame + Vector3.new(0, 5, 0)
            notify("Teleport", "Chegou em " .. nome .. "!")
        else
            notify("Erro", nome .. " nÃ£o disponÃ­vel.")
        end
    end,
})

T.Play:AddButton({
    Title = "ğŸ”„ Atualizar Lista de Jogadores",
    Callback = function()
        local lista = playerList()
        dropTpPlayer:SetValues(lista); dropTpPlayer:SetValue(lista[1])
        notify("Atualizado", #lista .. " jogador(es) encontrado(s).")
    end,
})

Players.PlayerAdded:Connect(function()
    task.wait(1); local l = playerList(); dropTpPlayer:SetValues(l)
end)
Players.PlayerRemoving:Connect(function()
    task.wait(0.5); local l = playerList(); dropTpPlayer:SetValues(l)
end)

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                   ABA  BROOKHAVEN                          â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- â•â• CAR SPEED (CORRIGIDO) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- O Brookhaven reseta MaxSpeed via scripts internos a cada frame.
-- A soluÃ§Ã£o Ã© um loop Heartbeat que FORÃ‡A o valor constantemente,
-- sobrescrevendo o script do jogo antes que ele tome efeito.

T.BK:AddParagraph({
    Title   = "ğŸš— Velocidade de VeÃ­culo",
    Content = "Ative o toggle DEPOIS de entrar no veÃ­culo.\nO loop forÃ§a a velocidade a cada frame, sobrescrevendo o script do Brookhaven.",
})

T.BK:AddSlider("CarSpeed", {
    Title = "Velocidade MÃ¡xima (MaxSpeed)", Description = "PadrÃ£o Brookhaven: ~80 | Recomendado: atÃ© 500",
    Default = 80, Min = 0, Max = 1000, Rounding = 0,
    Callback = function(v)
        -- Atualiza em tempo real se o loop jÃ¡ estiver ativo
        local s = findAnyVehicleSeat()
        if s then s.MaxSpeed = v end
    end,
})

T.BK:AddSlider("CarTorque", {
    Title = "Torque (aceleraÃ§Ã£o)", Description = "PadrÃ£o: ~200",
    Default = 200, Min = 50, Max = 9999, Rounding = 0,
    Callback = function(v)
        local s = findAnyVehicleSeat()
        if s then s.Torque = v end
    end,
})

T.BK:AddToggle("CarLoop", {
    Title       = "ğŸ” Ativar Speed Hack (loop forÃ§ado)",
    Description = "ForÃ§a MaxSpeed e Torque a cada frame â€” necessÃ¡rio no Brookhaven",
    Default     = false,
    Callback    = function(v)
        dis("carloop")
        if not v then
            -- Restaura padrÃ£o ao desativar
            local s = findAnyVehicleSeat()
            if s then s.MaxSpeed = 80; s.Torque = 200 end
            notify("Carro", "Speed hack desativado. Valores restaurados.")
            return
        end
        notify("Carro ğŸš—", "Speed hack ativado! Entre no veÃ­culo e acelere.")
        con("carloop", RunService.Heartbeat, function()
            local s = findAnyVehicleSeat(); if not s then return end
            -- ForÃ§a os valores a cada frame, antes do script do Brookhaven resetar
            local spd = Options.CarSpeed  and Options.CarSpeed.Value  or 80
            local trq = Options.CarTorque and Options.CarTorque.Value or 200
            -- Usa pcall pra nÃ£o quebrar se o seat for protegido
            pcall(function()
                if s.MaxSpeed ~= spd then s.MaxSpeed = spd end
                if s.Torque   ~= trq then s.Torque   = trq end
            end)
        end)
    end,
})

T.BK:AddButton({
    Title = "âœ… Aplicar uma vez no Carro Atual",
    Description = "Aplica sem o loop â€” use se o loop nÃ£o funcionar",
    Callback = function()
        local s = findAnyVehicleSeat()
        if not s then
            notify("Erro", "Nenhum VehicleSeat encontrado prÃ³ximo (<=20 studs).\nEntre no carro primeiro!")
            return
        end
        local spd = Options.CarSpeed  and Options.CarSpeed.Value  or 80
        local trq = Options.CarTorque and Options.CarTorque.Value or 200
        pcall(function()
            s.MaxSpeed = spd
            s.Torque   = trq
        end)
        notify("Carro âœ…", ("Speed: %d | Torque: %d\nSeat: %s"):format(spd, trq, s.Name))
    end,
})

-- â•â• VIEW PLAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Muda o CameraSubject para o HumanoidRootPart do alvo,
-- colocando sua cÃ¢mera na perspectiva exata dele.

T.BK:AddParagraph({
    Title   = "ğŸ‘ï¸ View Player",
    Content = "Sua cÃ¢mera vai para a perspectiva do jogador escolhido.\nDesative para voltar ao normal.",
})

local origCamSubject = nil
local origCamType    = nil

local dropAlvo = T.BK:AddDropdown("AlvoGeral", {
    Title       = "Selecionar Alvo (View / Fling)",
    Description = "Usado tanto pelo View quanto pelos flings",
    Values      = playerList(),
    Default     = playerList()[1],
    Multi       = false,
    Callback    = function(_) end,
})

T.BK:AddToggle("ViewActive", {
    Title       = "ğŸ‘ï¸ Ativar View",
    Description = "Coloca sua cÃ¢mera na visÃ£o do jogador selecionado",
    Default     = false,
    Callback    = function(v)
        local cam = getCam()

        if not v then
            -- Restaura cÃ¢mera original
            dis("view_lock")
            cam.CameraType = origCamType or Enum.CameraType.Custom
            if origCamSubject then
                cam.CameraSubject = origCamSubject
            else
                local hum = getHum()
                if hum then cam.CameraSubject = hum end
            end
            origCamSubject = nil
            origCamType    = nil
            notify("View", "CÃ¢mera restaurada.")
            return
        end

        local nome = Options.AlvoGeral and Options.AlvoGeral.Value
        local alvo = nome and Players:FindFirstChild(nome)
        if not alvo then notify("Erro", "Jogador nÃ£o encontrado."); return end

        local alvoChar = alvo.Character
        local alvoHum  = alvoChar and alvoChar:FindFirstChildOfClass("Humanoid")
        if not alvoHum then
            notify("Erro", alvo.Name .. " nÃ£o tem personagem no momento."); return
        end

        -- Salva estado atual da cÃ¢mera
        origCamSubject = cam.CameraSubject
        origCamType    = cam.CameraType

        -- Muda cÃ¢mera para seguir o alvo
        cam.CameraType    = Enum.CameraType.Custom
        cam.CameraSubject = alvoHum

        -- Reconecta se o alvo respawnar
        con("view_lock", Players.LocalPlayer.CharacterAdded, function()
            task.wait(1)
            local newChar = alvo.Character
            local newHum  = newChar and newChar:FindFirstChildOfClass("Humanoid")
            if newHum and Options.ViewActive and Options.ViewActive.Value then
                cam.CameraSubject = newHum
            end
        end)

        notify("View ğŸ‘ï¸", "CÃ¢mera travada em " .. alvo.Name .. "!\nDesative o toggle para voltar.")
    end,
})

T.BK:AddButton({
    Title = "ğŸ”„ Atualizar Lista (View / Fling)",
    Callback = function()
        local lista = playerList()
        dropAlvo:SetValues(lista);     dropAlvo:SetValue(lista[1])
        dropTpPlayer:SetValues(lista); dropTpPlayer:SetValue(lista[1])
        notify("Atualizado", #lista .. " jogador(es).")
    end,
})

-- â•â• FLING PLAYERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T.BK:AddParagraph({
    Title   = "ğŸ’€ Fling Players",
    Content = "âš½ Bola  â€” Spama bola atÃ© voar\nâ›µ Barco â€” Spama barco atÃ© voar\nğŸ›‹ï¸ SofÃ¡  â€” TP no void junto com o alvo",
})

T.BK:AddButton({
    Title = "âš½ Fling com Bola",
    Description = "Spama a bola no alvo repetidamente",
    Callback = function()
        local nome = Options.AlvoGeral and Options.AlvoGeral.Value
        local alvo = nome and Players:FindFirstChild(nome)
        if not alvo or not alvo.Character then
            notify("Erro", "Selecione um alvo vÃ¡lido."); return
        end

        local ball = findTool("Ball", "Bola", "Soccer", "Football", "SoccerBall", "BasketBall", "Balloon")
        if not ball then notify("Erro âš½", "Nenhuma bola encontrada no mapa!"); return end

        notify("Fling âš½", "Spamando bola em " .. nome .. "...")

        local h = getHum()
        if h and ball:IsA("Tool") then h:EquipTool(ball); task.wait(0.15) end

        task.spawn(function()
            local part = (ball:IsA("BasePart") and ball) or ball:FindFirstChildOfClass("BasePart")

            for _ = 1, 30 do
                local alvoRoot = alvo.Character and alvo.Character:FindFirstChild("HumanoidRootPart")
                if not alvoRoot then break end

                if part then
                    part.CFrame = alvoRoot.CFrame + Vector3.new(0, 1, 0)
                    local bv = Instance.new("BodyVelocity", part)
                    bv.MaxForce = Vector3.new(1e9, 1e9, 1e9)
                    bv.Velocity = Vector3.new(
                        math.random(-1, 1) * 999,
                        math.random(300, 999),
                        math.random(-1, 1) * 999
                    )
                    Debris:AddItem(bv, 0.05)
                else
                    -- Fallback: projÃ©til do prÃ³prio char
                    local myRoot = getRoot(); if not myRoot then break end
                    myRoot.CFrame = alvoRoot.CFrame + Vector3.new(0, 2, 0)
                    local bv = Instance.new("BodyVelocity", myRoot)
                    bv.MaxForce = Vector3.new(1e8, 1e8, 1e8)
                    bv.Velocity = (alvoRoot.Position - myRoot.Position).Unit * 999
                    Debris:AddItem(bv, 0.05)
                end
                task.wait(0.05)
            end
            notify("Fling âš½", nome .. " deve ter saÃ­do voando!")
        end)
    end,
})

T.BK:AddButton({
    Title = "â›µ Fling com Barco",
    Description = "Spama o barco em cima do alvo",
    Callback = function()
        local nome = Options.AlvoGeral and Options.AlvoGeral.Value
        local alvo = nome and Players:FindFirstChild(nome)
        if not alvo or not alvo.Character then
            notify("Erro", "Selecione um alvo vÃ¡lido."); return
        end

        local boat = findTool("Boat", "Barco", "Speedboat", "Sailboat", "Motorboat", "Yacht", "Ship")
        if not boat then notify("Erro â›µ", "Nenhum barco encontrado no mapa!"); return end

        notify("Fling â›µ", "Spamando barco em " .. nome .. "...")

        task.spawn(function()
            local boatPart = boat:IsA("BasePart") and boat
                or boat:FindFirstChild("VehicleSeat")
                or boat:FindFirstChildOfClass("BasePart")

            if not boatPart then notify("Erro â›µ", "Barco sem BasePart."); return end

            local seat = boat:FindFirstChild("VehicleSeat") or (boat:IsA("VehicleSeat") and boat)
            if seat then pcall(function() seat.MaxSpeed = 9999; seat.Torque = 9999 end) end

            for _ = 1, 25 do
                local alvoRoot = alvo.Character and alvo.Character:FindFirstChild("HumanoidRootPart")
                if not alvoRoot then break end

                pcall(function()
                    boatPart.CFrame = alvoRoot.CFrame + Vector3.new(0, 10, 0)
                    local bv = Instance.new("BodyVelocity", boatPart)
                    bv.MaxForce = Vector3.new(1e9, 1e9, 1e9)
                    bv.Velocity = Vector3.new(
                        math.random(-400, 400),
                        -800,
                        math.random(-400, 400)
                    )
                    Debris:AddItem(bv, 0.06)
                end)
                task.wait(0.06)
            end
            notify("Fling â›µ", nome .. " deve ter saÃ­do voando!")
        end)
    end,
})

T.BK:AddButton({
    Title = "ğŸ›‹ï¸ Void com SofÃ¡",
    Description = "VocÃª pega o sofÃ¡ e dÃ¡ TP no void junto com o alvo",
    Callback = function()
        local nome = Options.AlvoGeral and Options.AlvoGeral.Value
        local alvo = nome and Players:FindFirstChild(nome)
        if not alvo or not alvo.Character then
            notify("Erro", "Selecione um alvo vÃ¡lido."); return
        end

        local alvoRoot = alvo.Character:FindFirstChild("HumanoidRootPart")
        local myRoot   = getRoot()
        if not alvoRoot or not myRoot then return end

        local sofa = findTool("Sofa", "SofÃ¡", "Couch", "Furniture", "Loveseat", "Armchair")
        if not sofa then
            notify("Erro ğŸ›‹ï¸", "Nenhum sofÃ¡ encontrado!\nPegue um sofÃ¡ no Brookhaven primeiro.")
            return
        end

        notify("Void ğŸ›‹ï¸", "Indo pro void com " .. nome .. "...")

        task.spawn(function()
            -- Equipa o sofÃ¡
            local h = getHum()
            if h and sofa:IsA("Tool") then
                h:EquipTool(sofa); task.wait(0.2)
            end

            local startPos = myRoot.Position
            local voidY    = -5000
            local steps    = 40

            for i = 1, steps do
                myRoot   = getRoot()
                alvoRoot = alvo.Character and alvo.Character:FindFirstChild("HumanoidRootPart")
                if not myRoot or not alvoRoot then break end

                local t    = i / steps
                local newY = startPos.Y + (voidY - startPos.Y) * t

                -- Move os dois juntos pro void
                pcall(function()
                    myRoot.CFrame   = CFrame.new(startPos.X, newY, startPos.Z)
                    alvoRoot.CFrame = CFrame.new(startPos.X + 2, newY, startPos.Z)
                end)
                task.wait(0.025)
            end

            notify("Void ğŸ›‹ï¸", nome .. " foi pro void!\nDÃª respawn para voltar.")
        end)
    end,
})

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                     ABA  VISUAL                            â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T.Vis:AddToggle("FullBright", {
    Title = "FullBright", Description = "Remove escuridÃ£o, nÃ©voa e sombras",
    Default = false,
    Callback = function(v)
        if v then
            Lighting.Brightness = 10; Lighting.ClockTime = 14
            Lighting.FogEnd = 1e9;    Lighting.GlobalShadows = false
            Lighting.Ambient = Color3.fromRGB(255, 255, 255)
        else
            for k, val in pairs(ORIG) do Lighting[k] = val end
        end
    end,
})

T.Vis:AddSlider("FOV", {
    Title = "FOV", Description = "PadrÃ£o: 70",
    Default = 70, Min = 30, Max = 120, Rounding = 0,
    Callback = function(v) getCam().FieldOfView = v end,
})

con("camfov", workspace:GetPropertyChangedSignal("CurrentCamera"), function()
    task.wait()
    if Options.FOV then getCam().FieldOfView = Options.FOV.Value end
end)

-- ESP
local espBoards = {}

local function clearESP()
    for _, v in pairs(espBoards) do pcall(function() v:Destroy() end) end
    espBoards = {}
    for k in pairs(C) do if k:sub(1, 4) == "esp_" then dis(k) end end
end

local function buildESP()
    clearESP()
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr == LP then continue end
        local function setup(char)
            if not char then return end
            task.wait(1)
            local root = char:FindFirstChild("HumanoidRootPart")
            if not root then return end

            local bb = Instance.new("BillboardGui")
            bb.Adornee = root; bb.AlwaysOnTop = true
            bb.Size = UDim2.fromOffset(150, 56)
            bb.StudsOffset = Vector3.new(0, 4, 0)
            bb.Parent = root

            local bg = Instance.new("Frame", bb)
            bg.BackgroundColor3 = Color3.fromRGB(12, 12, 12)
            bg.BackgroundTransparency = 0.3
            bg.BorderSizePixel = 0
            bg.Size = UDim2.fromScale(1, 1)
            Instance.new("UICorner", bg).CornerRadius = UDim.new(0, 6)

            local function lbl(y, h, cor, font)
                local l = Instance.new("TextLabel", bg)
                l.Size = UDim2.new(1, -4, 0, h)
                l.Position = UDim2.fromOffset(2, y)
                l.BackgroundTransparency = 1
                l.TextColor3 = cor
                l.TextStrokeTransparency = 0.4
                l.TextScaled = true
                l.Font = font or Enum.Font.Gotham
                l.TextXAlignment = Enum.TextXAlignment.Center
                l.Text = "..."
                return l
            end

            local nameL = lbl(2,  22, Color3.fromRGB(255, 220, 60), Enum.Font.GothamBold)
            local hpL   = lbl(26, 16, Color3.fromRGB(100, 255, 100))
            local toolL = lbl(44, 14, Color3.fromRGB(200, 200, 255))
            nameL.Text  = plr.DisplayName

            con("esp_" .. plr.UserId, RunService.Heartbeat, function()
                local hum = char:FindFirstChildOfClass("Humanoid")
                if not hum or not hpL.Parent then return end
                local pct = hum.Health / hum.MaxHealth
                hpL.TextColor3 = Color3.fromRGB(
                    math.floor(255 * (1 - pct)), math.floor(255 * pct), 50)
                hpL.Text = ("â¤ %d  (%d%%)"):format(math.floor(hum.Health), math.floor(pct * 100))
                local tool = char:FindFirstChildOfClass("Tool")
                toolL.Text = tool and ("ğŸ”§ " .. tool.Name) or ""
            end)

            table.insert(espBoards, bb)
        end
        setup(plr.Character)
        plr.CharacterAdded:Connect(setup)
    end
end

T.Vis:AddToggle("ESP", {
    Title = "ESP  (Nome + HP + Ferramenta)", Description = "Verde = vivo Â· Vermelho = quase morto",
    Default = false,
    Callback = function(v)
        if v then
            buildESP()
            con("esp_add", Players.PlayerAdded, function(p)
                p.CharacterAdded:Connect(function() task.wait(1); buildESP() end)
            end)
            con("esp_rem", Players.PlayerRemoving, function()
                task.wait(0.5); buildESP()
            end)
        else
            clearESP(); dis("esp_add"); dis("esp_rem")
        end
    end,
})

T.Vis:AddToggle("Tracers", {
    Title = "Tracers", Description = "Linha da tela atÃ© cada jogador",
    Default = false,
    Callback = function(v)
        dis("tracers")
        local sg = LP.PlayerGui:FindFirstChild("_TR")
        if sg then sg:Destroy() end
        if not v then return end

        local gui = Instance.new("ScreenGui", LP.PlayerGui)
        gui.Name = "_TR"; gui.ResetOnSpawn = false; gui.IgnoreGuiInset = true

        con("tracers", RunService.RenderStepped, function()
            for _, f in ipairs(gui:GetChildren()) do f:Destroy() end
            local cam  = getCam()
            local vp   = cam.ViewportSize
            local orig = Vector2.new(vp.X / 2, vp.Y)

            for _, plr in ipairs(Players:GetPlayers()) do
                if plr == LP then continue end
                local char = plr.Character
                local root = char and char:FindFirstChild("HumanoidRootPart")
                if not root then continue end
                local sp, on = cam:WorldToViewportPoint(root.Position)
                if not on then continue end
                local dest  = Vector2.new(sp.X, sp.Y)
                local delta = dest - orig
                local line  = Instance.new("Frame", gui)
                line.AnchorPoint      = Vector2.new(0, 0.5)
                line.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
                line.BorderSizePixel  = 0
                line.Rotation         = math.deg(math.atan2(delta.Y, delta.X))
                line.Size             = UDim2.fromOffset(delta.Magnitude, 2)
                line.Position         = UDim2.fromOffset(orig.X, orig.Y)
            end
        end)
    end,
})

T.Vis:AddToggle("Crosshair", {
    Title = "Crosshair", Description = "Mira no centro da tela",
    Default = false,
    Callback = function(v)
        local e = LP.PlayerGui:FindFirstChild("_CH"); if e then e:Destroy() end
        if not v then return end
        local sg = Instance.new("ScreenGui", LP.PlayerGui)
        sg.Name = "_CH"; sg.ResetOnSpawn = false; sg.IgnoreGuiInset = true
        local function bar(w, h, ox, oy)
            local f = Instance.new("Frame", sg)
            f.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            f.BorderSizePixel  = 0
            f.Size             = UDim2.fromOffset(w, h)
            f.Position         = UDim2.new(.5, ox - w/2, .5, oy - h/2)
        end
        bar(14, 2, 0, 0); bar(2, 14, 0, 0)
    end,
})

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                      ABA  MUNDO                            â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T.Wld:AddSlider("Gravity", {
    Title = "Gravidade", Description = "PadrÃ£o: 196.2",
    Default = 196, Min = 0, Max = 800, Rounding = 0,
    Callback = function(v) workspace.Gravity = v end,
})

local function weather(ct, bright, fe, r, g, b)
    Lighting.ClockTime = ct;   Lighting.Brightness = bright
    Lighting.FogEnd    = fe;   Lighting.Ambient    = Color3.fromRGB(r, g, b)
end

T.Wld:AddButton({ Title = "â˜€ï¸ Normal",        Callback = function() weather(14, 2,   1e6, 100,100,100) end })
T.Wld:AddButton({ Title = "ğŸŒ™ Noite Fechada", Callback = function() weather(0,  0,   200, 20,20,60)    end })
T.Wld:AddButton({ Title = "ğŸŒ… PÃ´r do Sol",    Callback = function() weather(18, 1.5, 800, 255,140,60)  end })
T.Wld:AddButton({ Title = "ğŸŒŒ Madrugada",     Callback = function() weather(3,  0.2, 300, 30,30,80)    end })
T.Wld:AddButton({ Title = "ğŸŒ«ï¸ NÃ©voa Densa",   Callback = function()
    Lighting.ClockTime = 10; Lighting.FogEnd = 80
    Lighting.FogColor  = Color3.fromRGB(180,180,180); Lighting.Brightness = 1
end })

T.Wld:AddButton({
    Title = "ğŸ” Resetar Mundo",
    Callback = function()
        workspace.Gravity = 196.2; Options.Gravity:SetValue(196)
        for k, val in pairs(ORIG) do Lighting[k] = val end
        notify("Reset", "Mundo restaurado ao original.")
    end,
})

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                       ABA  MISC                            â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T.Mis:AddButton({
    Title = "ğŸ“‹ Copiar PosiÃ§Ã£o Atual",
    Description = "Copia as coordenadas para o clipboard",
    Callback = function()
        local root = getRoot(); if not root then return end
        local p   = root.Position
        local str = ("Vector3.new(%.2f, %.2f, %.2f)"):format(p.X, p.Y, p.Z)
        setclipboard(str)
        notify("Copiado!", str, 5)
    end,
})

T.Mis:AddButton({
    Title = "ğŸ–¥ï¸ Info do Servidor",
    Callback = function()
        notify("Info", ("Jogadores: %d/%d\nPlace ID: %d\nJob: %s"):format(
            #Players:GetPlayers(), Players.MaxPlayers,
            game.PlaceId, game.JobId:sub(1, 14) .. "..."), 8)
    end,
})

T.Mis:AddToggle("DeletePart", {
    Title = "ğŸ—‘ï¸ Deletar Parte (clique)",
    Description = "Clique em objetos do mapa para remover localmente",
    Default = false,
    Callback = function(v)
        dis("delpart")
        if not v then return end
        con("delpart", UserInput.InputBegan, function(inp)
            if inp.UserInputType ~= Enum.UserInputType.MouseButton1 then return end
            if not (Options.DeletePart and Options.DeletePart.Value) then return end
            local target = getMouse().Target
            if target and not Players:GetPlayerFromCharacter(target.Parent) then
                target:Destroy()
                notify("Deletado", "Parte removida localmente.")
            end
        end)
    end,
})

T.Mis:AddToggle("ClickTP", {
    Title = "âš¡ Click TP (clique em jogador)",
    Description = "Clique em outro jogador para teleportar atÃ© ele",
    Default = false,
    Callback = function(v)
        dis("clicktp")
        if not v then return end
        con("clicktp", UserInput.InputBegan, function(inp)
            if inp.UserInputType ~= Enum.UserInputType.MouseButton1 then return end
            if not (Options.ClickTP and Options.ClickTP.Value) then return end
            local target = getMouse().Target; local root = getRoot()
            if not (target and root) then return end
            local char = target:FindFirstAncestorOfClass("Model")
            local plr  = char and Players:GetPlayerFromCharacter(char)
            if plr and plr ~= LP then
                local tr = char:FindFirstChild("HumanoidRootPart")
                if tr then
                    root.CFrame = tr.CFrame + Vector3.new(0, 3, 0)
                    notify("ClickTP", "Teleportado para " .. plr.Name)
                end
            end
        end)
    end,
})

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘               SAVE / INTERFACE MANAGER                     â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SaveManager:SetLibrary(Fluent)
InterfaceManager:SetLibrary(Fluent)
SaveManager:IgnoreThemeSettings()
SaveManager:SetIgnoreIndexes({})
InterfaceManager:SetFolder("FluentHub")
SaveManager:SetFolder("FluentHub/BrookhavenV7")
InterfaceManager:BuildInterfaceSection(T.Cfg)
SaveManager:BuildConfigSection(T.Cfg)

Window:SelectTab(1)
SaveManager:LoadAutoloadConfig()

notify(
    "Brookhaven Admin HD  v7 ğŸ”¥",
    ("Carregado!\n%d jogadores online  Â·  RCtrl = minimizar"):format(#Players:GetPlayers()),
    7
)
